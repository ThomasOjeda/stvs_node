import{Tb as c,g as d,ga as h,i as a,lb as g,pa as u}from"./chunk-XFNI64LT.js";function l(r){this.message=r}l.prototype=new Error,l.prototype.name="InvalidCharacterError";var f=typeof window<"u"&&window.atob&&window.atob.bind(window)||function(r){var o=String(r).replace(/=+$/,"");if(o.length%4==1)throw new l("'atob' failed: The string to be decoded is not correctly encoded.");for(var e,t,n=0,i=0,p="";t=o.charAt(i++);~t&&(e=n%4?64*e+t:t,n++%4)?p+=String.fromCharCode(255&e>>(-2*n&6)):0)t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(t);return p};function k(r){var o=r.replace(/-/g,"+").replace(/_/g,"/");switch(o.length%4){case 0:break;case 2:o+="==";break;case 3:o+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(f(e).replace(/(.)/g,function(t,n){var i=n.charCodeAt(0).toString(16).toUpperCase();return i.length<2&&(i="0"+i),"%"+i}))}(o)}catch{return f(o)}}function s(r){this.message=r}function w(r,o){if(typeof r!="string")throw new s("Invalid token specified");var e=(o=o||{}).header===!0?0:1;try{return JSON.parse(k(r.split(".")[e]))}catch(t){throw new s("Invalid token specified: "+t.message)}}s.prototype=new Error,s.prototype.name="InvalidTokenError";var m=w;var j=(()=>{class r{constructor(e,t,n){this.http=e,this.snackBar=t,this.router=n}login(e){this.http.post(`${c.apiUrl}/api/v1/auth/login`,e).subscribe({next:t=>{this.setToken(t.token)},error:t=>{console.log(t),this.snackBar.open("Email o contrase\xF1a invalidos","cerrar",{duration:3e3})},complete:()=>{this.handleLoginCompletion()}})}setToken(e){localStorage.setItem("authToken",e)}getToken(){return localStorage.getItem("authToken")}isLoggendIn(){return!!localStorage.getItem("authToken")}registerUser(e){return this.http.post(`${c.apiUrl}/api/v1/auth/register`,e)}logout(){localStorage.removeItem("authToken")}handleLoginCompletion(){this.router.navigate(["home"])}getRole(){return this.getToken()?m(this.getToken()).role:"none"}isAdmin(){return this.getRole()==="admin"}static{this.\u0275fac=function(t){return new(t||r)(a(h),a(g),a(u))}}static{this.\u0275prov=d({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();export{j as a};
