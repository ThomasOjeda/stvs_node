import{c as b,d as Ie,e as Fe,f as Re,h as Le}from"./chunk-X3P6VRX6.js";import{A as n,Aa as ie,Ab as q,B as u,C as V,D as O,Da as ae,Eb as xe,F as M,Fa as ne,Fb as ye,G as f,Gb as De,H as C,Ha as oe,I as j,J as P,K as B,L as U,Lb as k,M as r,N as T,O as E,Qa as v,S as J,Sb as Ee,U as H,V as A,Wa as F,Xa as re,aa as w,ab as me,bb as se,ca as K,cb as le,d as z,ea as W,fb as pe,gb as R,h as y,hb as ce,j as g,jb as L,k as D,kb as N,mb as de,n as _,na as X,nb as ue,o as h,ob as fe,pa as I,pb as ge,qb as _e,rb as he,s as m,sa as G,sb as Ce,t as d,ta as Y,tb as Te,ua as Q,ub as we,va as Z,vb as ve,w as c,wa as ee,wb as be,x as l,xa as te,xb as Me,ya as $,yb as Se,z as a}from"./chunk-XFNI64LT.js";var ze=()=>[15,30,45];function Ue(e,p){e&1&&(a(0,"th",14),r(1,"Identificador de etiqueta"),n())}function Je(e,p){if(e&1&&(a(0,"td",15),r(1),n()),e&2){let t=p.$implicit;m(),T(t._id)}}function Ke(e,p){e&1&&(a(0,"th",14),r(1,"Descripcion"),n())}function We(e,p){if(e&1&&(a(0,"td",15),r(1),n()),e&2){let t=p.$implicit;m(),T(t.description)}}function Xe(e,p){e&1&&u(0,"tr",16)}function Ye(e,p){if(e&1){let t=M();a(0,"tr",17),f("click",function(){let o=_(t).$implicit,s=C();return h(s.openDetails(o))}),n()}}function Ze(e,p){if(e&1&&(a(0,"tr",18)(1,"td",19),r(2),n()()),e&2){C();let t=U(4);m(2),E(' No se encontro una etiqueta con el filtro "',t.value,'" ')}}function et(e,p){e&1&&u(0,"app-shade-loading-spinner")}var Ve=(()=>{class e{constructor(t,i,o){this.tagsServ=t,this.router=i,this.dialog=o,this.columnsToDisplay=["_id","description"],this.isLoadingResults=!0}ngOnInit(){this.tagEventSubscription=this.newTagEvent.subscribe(t=>{t=="new"&&this.refresh()})}ngAfterViewInit(){this.dataSource=new Me,this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,this.refresh()}refresh(){this.isLoadingResults=!0,this.tagsServ.getTags().subscribe({next:t=>{this.dataSource.data=t.result},error:()=>{this.isLoadingResults=!1},complete:()=>{this.isLoadingResults=!1}})}applyFilter(t){let i=t.target.value;this.dataSource.filter=i.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}openDetails(t){this.router.navigate(["home","tags",t._id])}ngOnDestroy(){this.tagEventSubscription.unsubscribe()}static{this.\u0275fac=function(i){return new(i||e)(d(b),d(I),d(k))}}static{this.\u0275cmp=g({type:e,selectors:[["app-tag-list"]],viewQuery:function(i,o){if(i&1&&(j(q,5),j(Se,5)),i&2){let s;P(s=B())&&(o.paginator=s.first),P(s=B())&&(o.sort=s.first)}},inputs:{newTagEvent:"newTagEvent"},decls:19,vars:6,consts:[["input",""],[1,"filter"],["matInput","",3,"keyup"],["mat-table","",3,"dataSource"],["matColumnDef","_id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","description"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","row",3,"click",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["aria-label","Seleccione pagina de etiquetas",3,"pageSizeOptions"],["mat-button","",3,"click"],[4,"ngIf"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row","",1,"row",3,"click"],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(i,o){if(i&1){let s=M();a(0,"mat-form-field",1)(1,"mat-label"),r(2,"Filtrar"),n(),a(3,"input",2,0),f("keyup",function(He){return _(s),h(o.applyFilter(He))}),n()(),a(5,"table",3),V(6,4),c(7,Ue,2,0,"th",5)(8,Je,2,1,"td",6),O(),V(9,7),c(10,Ke,2,0,"th",5)(11,We,2,1,"td",6),O(),c(12,Xe,1,0,"tr",8)(13,Ye,1,0,"tr",9)(14,Ze,3,1,"tr",10),n(),u(15,"mat-paginator",11),a(16,"button",12),f("click",function(){return _(s),h(o.refresh())}),r(17,"Refresh"),n(),c(18,et,1,0,"app-shade-loading-spinner",13)}i&2&&(m(5),l("dataSource",o.dataSource),m(7),l("matHeaderRowDef",o.columnsToDisplay),m(),l("matRowDefColumns",o.columnsToDisplay),m(2),l("pageSizeOptions",J(5,ze)),m(3),l("ngIf",o.isLoadingResults))},dependencies:[w,Ie,v,N,L,R,de,fe,Ce,ge,ue,Te,_e,he,we,ve,be,q],styles:["[_nghost-%COMP%]{position:relative;width:100%;display:block}table[_ngcontent-%COMP%]{width:100%}mat-paginator[_ngcontent-%COMP%]{width:100%}.filter[_ngcontent-%COMP%]{display:block;width:200px}.row[_ngcontent-%COMP%]:hover{cursor:pointer;background-color:#ebebeb}"]})}}return e})();function it(e,p){e&1&&(a(0,"mat-error"),r(1," Campo "),a(2,"strong"),r(3,"requerido"),n()())}function at(e,p){e&1&&(a(0,"mat-error"),r(1," Campo "),a(2,"strong"),r(3,"requerido"),n()())}var Oe=(()=>{class e{constructor(t){this.tagsServ=t,this.newTagForm=new te({_id:new $("",[Q.required]),description:new $("",[Q.required])}),this.clearFormEnabled=!1}ngOnInit(){}onSubmit(){this.tagsServ.addTag(this.newTagForm.value).subscribe({next:t=>{},error:t=>{window.alert("No se ha podido registrar la etiqueta.")},complete:()=>{window.alert("Etiqueta agregada"),this.clearFormEnabled=!0,this.newTagCommand.next("new")}})}clearForm(){this.clearFormEnabled=!1,this.newTagForm.reset()}static{this.\u0275fac=function(i){return new(i||e)(d(b))}}static{this.\u0275cmp=g({type:e,selectors:[["app-new-tag"]],inputs:{newTagCommand:"newTagCommand"},decls:17,vars:5,consts:[[3,"ngSubmit","formGroup"],["formControlName","_id","type","text","matInput",""],[4,"ngIf"],["appearance","outline"],["formControlName","description","type","text","matInput",""],[1,"clear-control"],["type","button","mat-raised-button","","color","warn",3,"click","disabled"],["mat-button","","type","submit",3,"disabled"]],template:function(i,o){if(i&1&&(a(0,"form",0),f("ngSubmit",function(){return o.onSubmit()}),a(1,"mat-form-field")(2,"mat-label"),r(3,"Etiqueta"),n(),u(4,"input",1),c(5,it,4,0,"mat-error",2),n(),a(6,"mat-form-field",3)(7,"mat-label"),r(8,"Descripcion"),n(),u(9,"textarea",4),c(10,at,4,0,"mat-error",2),n(),a(11,"div",5)(12,"button",6),f("click",function(){return o.clearForm()}),r(13," Limpiar campos "),n()(),u(14,"mat-divider"),a(15,"button",7),r(16," Agregar "),n()()),i&2){let s,x;l("formGroup",o.newTagForm),m(5),l("ngIf",(s=o.newTagForm.get("_id"))==null?null:s.hasError("required")),m(5),l("ngIf",(x=o.newTagForm.get("description"))==null?null:x.hasError("required")),m(2),l("disabled",!o.clearFormEnabled),m(3),l("disabled",o.newTagForm.invalid)}},dependencies:[w,v,re,N,L,R,ce,ie,Y,Z,ee,ae,ne],styles:["form[_ngcontent-%COMP%]{width:80%;margin:auto}mat-form-field[_ngcontent-%COMP%]{width:100%}mat-divider[_ngcontent-%COMP%]{margin:20px 0}.clear-control[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}"]})}}return e})();function rt(e,p){e&1&&(a(0,"mat-icon"),r(1,"new_label"),n(),r(2," Crear nueva "))}function mt(e,p){e&1&&(a(0,"mat-icon"),r(1,"label"),n(),r(2," Lista de etiquetas "))}var je=(()=>{class e{constructor(){this.newTagCommand=new z}ngOnInit(){}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275cmp=g({type:e,selectors:[["app-tags-component"]],decls:7,vars:2,consts:[["mat-align-tabs","center","dynamicHeight",""],["mat-tab-label",""],[3,"newTagCommand"],[3,"newTagEvent"]],template:function(i,o){i&1&&(a(0,"mat-tab-group",0)(1,"mat-tab"),c(2,rt,3,0,"ng-template",1),u(3,"app-new-tag",2),n(),a(4,"mat-tab"),c(5,mt,3,0,"ng-template",1),u(6,"app-tag-list",3),n()()),i&2&&(m(3),l("newTagCommand",o.newTagCommand),m(3),l("newTagEvent",o.newTagCommand.asObservable()))},dependencies:[F,xe,ye,De,Ve,Oe]})}}return e})();function st(e,p){if(e&1){let t=M();a(0,"mat-card",1)(1,"mat-card-header")(2,"mat-card-title"),r(3),n()(),a(4,"mat-card-content")(5,"h2"),r(6,"Descripcion"),n(),a(7,"p",2)(8,"app-editable-text-field",3),f("wasModified",function(o){_(t);let s=C();return h(s.descriptionModified(o))}),n()(),a(9,"h2"),r(10,"Fecha de creaci\xF3n"),n(),a(11,"p"),r(12),H(13,"date"),n(),a(14,"h2"),r(15,"Ultima actualizaci\xF3n"),n(),a(16,"p"),r(17),H(18,"date"),n(),a(19,"button",4),f("click",function(){_(t);let o=C();return h(o.openDeleteDialog())}),a(20,"mat-icon",5),r(21,"delete"),n(),r(22," Borrar "),n()()()}if(e&2){let t=C();m(3),E('Detalles de la etiqueta "',t.tag._id,'"'),m(5),l("isTextArea",!1)("value",t.tag.description),m(4),T(A(13,5,t.tag.createdAt)),m(5),T(A(18,7,t.tag.updatedAt))}}var Pe=(()=>{class e{constructor(t,i,o,s){this.actRoute=t,this.tagsServ=i,this.dialog=o,this.router=s}ngOnInit(){this.actRoute.params.subscribe({next:t=>{this.requestTagData(t)},error:()=>{},complete:()=>{}})}requestTagData(t){this.tagsServ.getTag(t.id).subscribe({next:i=>{this.tag=i.result},error:()=>{},complete:()=>{}})}openDeleteDialog(){let t=this.dialog.open(Fe);t.componentInstance.title=`\xBFBorrar la etiqueta ${this.tag._id}?`,t.componentInstance.op1="Borrar",t.componentInstance.op2="Cancelar",t.componentInstance.result.subscribe(i=>{i=="Borrar"?this.tagsServ.deleteTag(this.tag).subscribe({next:()=>{},error:()=>{window.alert("No se pudo eliminar la etiqueta. \xBFEsta siendo usada por algun grafico?"),t.close()},complete:()=>{t.close(),this.router.navigate(["home","tags"])}}):t.close()})}descriptionModified(t){this.tag.description=t,this.tagsServ.updateTag(this.tag).subscribe(i=>{this.tag=i.result})}static{this.\u0275fac=function(i){return new(i||e)(d(X),d(b),d(k),d(I))}}static{this.\u0275cmp=g({type:e,selectors:[["app-tag-details"]],decls:1,vars:1,consts:[["appearance","outlined",4,"ngIf"],["appearance","outlined"],[2,"white-space","pre-wrap"],[3,"wasModified","isTextArea","value"],["mat-raised-button","",2,"color","red",3,"click"],["color","warn"]],template:function(i,o){i&1&&c(0,st,23,9,"mat-card",0),i&2&&l("ngIf",o.tag)},dependencies:[w,Re,v,F,me,le,pe,se,K],styles:[".mat-mdc-card-content[_ngcontent-%COMP%]{padding-left:1rem}"]})}}return e})();var lt=[{path:"",component:je},{path:":id",component:Pe}],Be=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=D({type:e})}static{this.\u0275inj=y({imports:[G.forChild(lt),G]})}}return e})();var Gt=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=D({type:e})}static{this.\u0275inj=y({imports:[W,Be,Le,Ee,oe]})}}return e})();export{Gt as TagsModule};
